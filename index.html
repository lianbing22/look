<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>恒泰视觉 AI 识别系统 - 实时物体识别</title>
    <meta name="description" content="恒泰视觉AI识别系统是一款基于TensorFlow.js的实时物体识别应用。">
    <meta name="keywords" content="AI识别,物体检测,TensorFlow.js,计算机视觉,人工智能,机器学习,实时识别">
    <meta name="author" content="恒泰科技">

    <link rel="manifest" href="manifest.json">
    <link rel="stylesheet" href="style.css">
    
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">
    <!-- Assume other PWA icons like icon-512x512, etc., would be here -->
    <meta name="theme-color" content="#ffffff">

    <!-- TensorFlow.js -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@3.18.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/coco-ssd@2.2.2"></script>
    
    <!-- Permissions Policy -->
    <meta http-equiv="Permissions-Policy" content="interest-cohort=()">
    
    <!-- Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
</head>
<body>
    <header class="app-header">
        <div class="app-header__container">
            <h1 class="app-header__title">恒泰视觉 AI</h1>
            <nav class="app-header__nav">
                <a href="#" class="app-header__nav-link active">首页</a>
                <a href="admin/index.html" class="app-header__nav-link">管理</a>
                <a href="#" id="helpBtn" class="app-header__nav-link">帮助</a>
            </nav>
        </div>
    </header>

    <main class="app-main">
        <section class="app-section app-section--camera">
            <div class="camera-view" id="cameraView">
                <div class="camera-view__container" id="cameraContainer">
                    <video id="video" autoplay playsinline muted></video>
                    <canvas id="canvas"></canvas>
                    <div id="cameraPlaceholder" class="camera-placeholder">
                        <div class="loading-spinner"></div>
                        <div class="loading-text">点击开始识别</div>
                    </div>
                </div>
            </div>
        </section>

        <section class="app-section app-section--controls">
            <div class="controls-bar" id="controlsBar">
                <button id="startBtn" class="control-button">
                    <span class="material-icons">play_arrow</span>开始识别
                </button>
                <button id="stopBtn" class="control-button" disabled>
                    <span class="material-icons">stop</span>停止识别
                </button>
                <button id="saveBtn" class="control-button" disabled>
                    <span class="material-icons">save</span>保存结果
                </button>
                <button id="refreshBtn" class="control-button control-button--icon" title="遇到问题时点击刷新页面">
                    <span class="material-icons">refresh</span> 刷新
                </button>
            </div>
        </section>

        <section class="app-section app-section--results">
            <div class="results-area" id="resultsArea">
                <h2 class="results-area__title">
                    识别结果
                    <a href="#" id="historyBtn" class="history-link" title="查看历史记录">
                        <span class="material-icons">history</span> 历史记录
                    </a>
                </h2>
                <div id="predictions" class="predictions-list">
                    <!-- Prediction items will be dynamically inserted here -->
                </div>
            </div>
        </section>
    </main>

    <!-- History Panel -->
    <aside id="historyPanel" class="history-panel">
        <div class="history-panel__header">
            <h3>识别历史记录</h3>
            <button id="historyCloseBtn" class="icon-button" aria-label="Close history panel">
                <span class="material-icons">close</span>
            </button>
        </div>
        <div id="historyContent" class="history-panel__content">
            <div class="history-empty">暂无保存的识别记录</div>
        </div>
        <button id="historyClearBtn" class="button--danger history-panel__clear-button">
            <span class="material-icons">delete_sweep</span>清空所有历史记录
        </button>
    </aside>

    <!-- Help Overlay -->
    <div id="helpOverlay" class="help-overlay">
        <div class="help-overlay__content">
            <button id="closeHelpBtn" class="icon-button help-overlay__close-button" aria-label="Close help">
                <span class="material-icons">close</span>
            </button>
            <h2>使用指南</h2>
            <div class="help-steps">
                <p><strong>第一步:</strong> 点击“开始识别”按钮启动摄像头。</p>
                <p><strong>第二步:</strong> 将摄像头对准您想要识别的物体。</p>
                <p><strong>第三步:</strong> 系统将实时显示识别结果。</p>
                <p><strong>第四步:</strong> 点击“保存结果”以保存当前帧和识别信息。</p>
            </div>
            <div class="help-tips">
                <h3>小贴士:</h3>
                <ul>
                    <li>确保光线充足以获得最佳识别效果。</li>
                    <li>尽量保持摄像头稳定。</li>
                    <li>识别结果仅供参考。</li>
                </ul>
            </div>
            <a href="https://www.example.com/hengtai-vision-tutorial" target="_blank" id="startTutorialBtn" class="button--primary">
                <span class="material-icons">school</span>查看详细教程
            </a>
        </div>
    </div>
    
    <!-- Save Dialog -->
    <div id="saveDialog" class="save-dialog">
        <div class="save-dialog-content">
             <h3>保存识别结果</h3>
             <img id="savePreview" class="save-preview" src="#" alt="识别结果预览图">
             <div class="save-form-group">
                 <label for="saveName">名称:</label>
                 <input type="text" id="saveName" placeholder="为此识别结果命名 (例如: 客厅场景)">
             </div>
             <div class="save-dialog-actions">
                 <button id="cancelSaveBtn" class="save-dialog-btn cancel">取消</button>
                 <button id="confirmSaveBtn" class="save-dialog-btn save">
                     <span class="material-icons">save</span>保存
                 </button>
             </div>
        </div>
    </div>

    <footer class="app-footer">
        <p>&copy; <span id="currentYear"></span> 恒泰视觉 AI 识别系统. 版权所有.</p>
        <p><a href="https://github.com/yourusername/hengtai-vision" target="_blank" rel="noopener">GitHub 项目</a> | <a href="#">隐私政策</a> | <a href="#">服务条款</a></p>
    </footer>

    <script src="script.js"></script>
    <script>
        // Update current year in footer
        document.getElementById('currentYear').textContent = new Date().getFullYear();

        // Service Worker registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('service-worker.js')
                    .then(registration => {
                        console.log('Service Worker 注册成功，范围:', registration.scope);
                    })
                    .catch(error => {
                        console.log('Service Worker 注册失败:', error);
                    });
            });
        }
    </script>
</body>
</html>
